CREATE TABLE `data_transformed.video_consults`
(
  consult_id STRING,
  appointment_date_time TIMESTAMP,
  appointment_month TIMESTAMP,
  insert_date_time DATETIME,
  update_date_time DATETIME,
  service_type STRING,
  longitude FLOAT64,
  latitude FLOAT64,
  consult_location STRING,
  consult_location_city STRING,
  consult_location_region STRING,
  consult_location_country STRING,
  consult_location_country_code STRING,
  service_route STRING,
  service_route_org_id STRING,
  service_route_org_name STRING,
  consult_status STRING,
  consult_doctor_reason_for_change STRING,
  is_prescribed BOOL,
  is_prescription_purchased BOOL,
  diagnosis STRING,
  secondary_diagnosis STRING,
  notes_to_patient STRING,
  remarks STRING,
  diagnosis_type STRING,
  is_ed BOOL,
  is_contraception BOOL,
  is_mc BOOL,
  consult_followup STRING,
  followup_consult_id STRING,
  previous_consult_id STRING,
  consult_programme_id STRING,
  consult_programme_name STRING,
  consult_duration INT64,
  patient_join_time DATETIME,
  doctor_join_time DATETIME,
  consult_type STRING,
  consult_clinic_name STRING,
  visit_no INT64,
  is_referral_issued BOOL,
  has_symptoms BOOL,
  consult_searching_time DATETIME,
  consult_searching_instances INT64,
  consult_booking_time DATETIME,
  consult_booking_instances INT64,
  consult_pending_docs_time DATETIME,
  consult_pending_docs_instances INT64,
  consult_expired_time DATETIME,
  consult_expired_instances INT64,
  consult_no_show_time DATETIME,
  consult_no_show_instances INT64,
  consult_canceled_time DATETIME,
  consult_canceled_instances INT64,
  consult_void_time DATETIME,
  consult_void_instances INT64,
  consult_not_suitable_time DATETIME,
  consult_not_suitable_instances INT64,
  consult_completed_time DATETIME,
  consult_completed_instances INT64,
  user_id STRING,
  phone_id INT64,
  patient_first_name BYTES,
  patient_last_name BYTES,
  patient_email_address BYTES,
  patient_phone_number BYTES,
  patient_nric BYTES,
  patient_consult_age INT64,
  patient_age INT64,
  patient_gender STRING,
  patient_birthday DATETIME,
  patient_nationality STRING,
  is_test_consult BOOL,
  doctor_id STRING,
  doctor_first_name BYTES,
  doctor_last_name BYTES,
  doctor_email_address BYTES,
  doctor_specialty STRING,
  doctor_specialty_type STRING,
  doctor_tier_id INT64,
  specialist_tier_name STRING,
  group_id STRING,
  group_name STRING,
  group_type STRING,
  group_primary_type STRING,
  group_secondary_type STRING,
  insurance STRING,
  consult_promo_code STRING,
  consult_promo_type STRING,
  consult_promo_subtype STRING,
  country STRING,
  transaction_currency STRING,
  consult_transaction_id STRING,
  consult_transaction_status STRING,
  consult_payment_provider_type STRING,
  consult_transaction_amount FLOAT64,
  consult_discount_amount FLOAT64,
  consult_tax_amount FLOAT64,
  consult_base_price FLOAT64,
  consult_transaction_reason_for_change STRING,
  medicine_transaction_status STRING,
  medicine_payment_provider_type STRING,
  medicine_transaction_amount FLOAT64,
  medicine_discount_amount FLOAT64,
  medicine_tax_amount FLOAT64,
  medicine_base_price FLOAT64,
  medication_transaction_reason_for_change STRING,
  refunded_consult_amount FLOAT64,
  refunded_consult_discount FLOAT64,
  refunded_consult_tax FLOAT64,
  refunded_medicine_amount FLOAT64,
  refunded_medicine_discount FLOAT64,
  refunded_medicine_tax FLOAT64,
  refund_consult_date_time DATETIME,
  is_consult_refunded BOOL,
  refund_medicine_date_time DATETIME,
  is_medication_refunded BOOL,
  transaction_user_category STRING,
  mc_days INT64,
  is_reschedule BOOL,
  minute_before_cancellation INT64,
  insurance_user_mapping_id INT64,
  insurance_member_id_number STRING,
  insurance_id_card_no BYTES,
  insurance_primary_authentication BYTES,
  insurance_secondary_authentication BYTES,
  insurance_policy_code STRING,
  insurance_policy_name STRING,
  insurance_policy_type STRING,
  insurance_policy_number STRING,
  insurance_full_name BYTES,
  total_price_with_tax FLOAT64,
  total_price FLOAT64,
  medicine_transaction_amount_before_refund FLOAT64,
  medicine_discount_amount_before_refund FLOAT64,
  medicine_tax_amount_before_refund FLOAT64,
  consult_transaction_amount_before_refund FLOAT64,
  consult_discount_amount_before_refund FLOAT64,
  consult_tax_amount_before_refund FLOAT64
)
PARTITION BY DATE(appointment_month);