CREATE TABLE `dotted-marking-256715.data_transformed.marketplace`
(
  id STRING,
  user_id STRING,
  purchase_list_id STRING,
  order_confirmation_no STRING,
  transaction_type_ref_id STRING,
  transaction_date DATETIME,
  transaction_type STRING,
  purchase_origin STRING,
  item_id STRING,
  item_type STRING,
  payment_type STRING,
  transaction_country STRING,
  currency STRING,
  transaction_id STRING,
  net_amount FLOAT64,
  discount_amount FLOAT64,
  total_price FLOAT64,
  net_amt_refunded FLOAT64,
  discount_refunded FLOAT64,
  admin_refunded FLOAT64,
  tax_refunded FLOAT64,
  refund_date_time DATETIME,
  is_test_transaction STRING,
  promo_code STRING,
  item_purchased STRING,
  quantity INT64,
  promo_type STRING,
  promo_subtype STRING,
  discount_type STRING,
  vendor_id STRING,
  vendor_name STRING,
  service_type STRING,
  transaction_status STRING,
  transaction_status_corrected STRING,
  gender STRING,
  age INT64,
  birthday DATETIME,
  nationality STRING,
  delivery_start_time DATETIME,
  encrypted_full_name BYTES,
  encrypted_user_email BYTES,
  encrypted_contact_number BYTES,
  encrypted_address BYTES,
  encrypted_postal_code BYTES,
  encrypted_nric BYTES
)
PARTITION BY DATETIME_TRUNC(transaction_date, MONTH);